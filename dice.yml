version: 2
envs:
  CSRF_ENABLE: true
  OSS_ENABLE: false
  ENABLE_SSR: false
  SSR_FALLBACK: false
services:
  herd:
    cmd: "echo 'Start bigWhite service ...' && npm run test"
    ports:
      - 8081
    resources:
      cpu: 1
      mem: 768
    deployments:
      replicas: 1
    health_check:
      http:
        port: 80
        path: "/health/check"
        duration: 180
environments:
  test:
    envs:
      NODE_ENV: "test"
      MYSQL_DATABASE: "big_white_test"
      TERMINUS_TA_ENABLE: true
    # addons:
    #   bigWhite-rds-write-prod:
    #     plan: "alicloud-rds:basic"
    #     version: "1.0.0"
  production:
    # addons:
    #   bigWhite-rds-write-prod:
    #     plan: "alicloud-rds:basic"
    # envs:
    #   NODE_ENV: "production"
    #   MYSQL_DATABASE: "big_white"
addons:
  bigWhite-rds-write-prod:
    plan: "mysql:basic"
    options:
      version: "5.7.23"
    create_dbs: big_white
